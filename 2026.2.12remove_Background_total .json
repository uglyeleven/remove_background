{"id":"aec444e6-14b7-40b7-be29-12eb99110bd7","revision":0,"last_node_id":86,"last_link_id":194,"nodes":[{"id":80,"type":"Mask Crop Region","pos":[-2274.26953125,215.0089111328125],"size":[270,222],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"mask","name":"mask","type":"MASK","link":173},{"localized_name":"padding","name":"padding","type":"INT","widget":{"name":"padding"},"link":null},{"localized_name":"region_type","name":"region_type","type":"COMBO","widget":{"name":"region_type"},"link":null}],"outputs":[{"localized_name":"cropped_mask","name":"cropped_mask","type":"MASK","links":null},{"localized_name":"crop_data","name":"crop_data","type":"CROP_DATA","links":null},{"localized_name":"top_int","name":"top_int","type":"INT","links":[182]},{"localized_name":"left_int","name":"left_int","type":"INT","links":[183]},{"localized_name":"right_int","name":"right_int","type":"INT","links":[184]},{"localized_name":"bottom_int","name":"bottom_int","type":"INT","links":[185]},{"localized_name":"width_int","name":"width_int","type":"INT","links":null},{"localized_name":"height_int","name":"height_int","type":"INT","links":null}],"properties":{"cnr_id":"was-ns","ver":"3.0.1","Node name for S&R":"Mask Crop Region"},"widgets_values":[0,"dominant"]},{"id":55,"type":"Image Save","pos":[-2276.502197265625,-637.9398193359375],"size":[306.1015625,626],"flags":{},"order":17,"mode":0,"inputs":[{"localized_name":"images","name":"images","type":"IMAGE","link":135},{"localized_name":"output_path","name":"output_path","type":"STRING","widget":{"name":"output_path"},"link":null},{"localized_name":"filename_prefix","name":"filename_prefix","type":"STRING","widget":{"name":"filename_prefix"},"link":null},{"localized_name":"filename_delimiter","name":"filename_delimiter","type":"STRING","widget":{"name":"filename_delimiter"},"link":null},{"localized_name":"filename_number_padding","name":"filename_number_padding","type":"INT","widget":{"name":"filename_number_padding"},"link":null},{"localized_name":"filename_number_start","name":"filename_number_start","type":"COMBO","widget":{"name":"filename_number_start"},"link":null},{"localized_name":"extension","name":"extension","type":"COMBO","widget":{"name":"extension"},"link":null},{"localized_name":"dpi","name":"dpi","type":"INT","widget":{"name":"dpi"},"link":null},{"localized_name":"quality","name":"quality","type":"INT","widget":{"name":"quality"},"link":null},{"localized_name":"optimize_image","name":"optimize_image","type":"COMBO","widget":{"name":"optimize_image"},"link":null},{"localized_name":"lossless_webp","name":"lossless_webp","type":"COMBO","widget":{"name":"lossless_webp"},"link":null},{"localized_name":"overwrite_mode","name":"overwrite_mode","type":"COMBO","widget":{"name":"overwrite_mode"},"link":null},{"localized_name":"show_history","name":"show_history","type":"COMBO","widget":{"name":"show_history"},"link":null},{"localized_name":"show_history_by_prefix","name":"show_history_by_prefix","type":"COMBO","widget":{"name":"show_history_by_prefix"},"link":null},{"localized_name":"embed_workflow","name":"embed_workflow","type":"COMBO","widget":{"name":"embed_workflow"},"link":null},{"localized_name":"show_previews","name":"show_previews","type":"COMBO","widget":{"name":"show_previews"},"link":null}],"outputs":[{"localized_name":"images","name":"images","type":"IMAGE","links":null},{"localized_name":"files","name":"files","type":"STRING","links":null}],"properties":{"cnr_id":"was-ns","ver":"3.0.1","Node name for S&R":"Image Save"},"widgets_values":["E:\\ComfyUI\\ComfyUI-aki-v2\\ComfyUI\\input\\work\\output\\111","","_",4,"false","jpg",300,100,"true","false","false","false","true","true","true"],"color":"#223","bgcolor":"#335"},{"id":52,"type":"RMBG","pos":[-1956.867431640625,-336.5328674316406],"size":[340,302],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"IMAGE","link":88},{"localized_name":"模型","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"灵敏度","name":"sensitivity","shape":7,"type":"FLOAT","widget":{"name":"sensitivity"},"link":null},{"localized_name":"处理分辨率","name":"process_res","shape":7,"type":"INT","widget":{"name":"process_res"},"link":null},{"localized_name":"遮罩模糊","name":"mask_blur","shape":7,"type":"INT","widget":{"name":"mask_blur"},"link":null},{"localized_name":"遮罩偏移","name":"mask_offset","shape":7,"type":"INT","widget":{"name":"mask_offset"},"link":null},{"localized_name":"反转输出","name":"invert_output","shape":7,"type":"BOOLEAN","widget":{"name":"invert_output"},"link":null},{"localized_name":"精细前景优化","name":"refine_foreground","shape":7,"type":"BOOLEAN","widget":{"name":"refine_foreground"},"link":null},{"localized_name":"背景类型","name":"background","shape":7,"type":"COMBO","widget":{"name":"background"},"link":null},{"localized_name":"背景颜色","name":"background_color","shape":7,"type":"COLORCODE","widget":{"name":"background_color"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[160,181]},{"localized_name":"遮罩","name":"MASK","type":"MASK","links":[]},{"localized_name":"遮罩图像","name":"MASK_IMAGE","type":"IMAGE","links":[]}],"properties":{"cnr_id":"comfyui-rmbg","ver":"2.9.6","Node name for S&R":"RMBG"},"widgets_values":["RMBG-2.0",1,1024,0,0,false,false,"Alpha","#ffffff"],"color":"#223","bgcolor":"#335"},{"id":81,"type":"Image Crop Location","pos":[-1928.3551025390625,226.2273406982422],"size":[270,150],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":181},{"localized_name":"top","name":"top","type":"INT","widget":{"name":"top"},"link":182},{"localized_name":"left","name":"left","type":"INT","widget":{"name":"left"},"link":183},{"localized_name":"right","name":"right","type":"INT","widget":{"name":"right"},"link":184},{"localized_name":"bottom","name":"bottom","type":"INT","widget":{"name":"bottom"},"link":185}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[180,187]},{"localized_name":"CROP_DATA","name":"CROP_DATA","type":"CROP_DATA","links":null}],"properties":{"cnr_id":"was-ns","ver":"3.0.1","Node name for S&R":"Image Crop Location"},"widgets_values":[255,0,256,256]},{"id":57,"type":"GetImageSize","pos":[-1567.814208984375,-22.27922821044922],"size":[380.08734130859375,214.47500610351562],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"IMAGE","link":180}],"outputs":[{"localized_name":"width","name":"width","type":"INT","links":[93,96]},{"localized_name":"height","name":"height","type":"INT","links":[94,98]},{"localized_name":"batch_size","name":"batch_size","type":"INT","links":null}],"properties":{"cnr_id":"comfy-core","ver":"0.3.49","Node name for S&R":"GetImageSize"},"widgets_values":[],"color":"#232","bgcolor":"#353"},{"id":60,"type":"MathExpression|pysssss","pos":[-1152.860107421875,251.92588806152344],"size":[400,200],"flags":{},"order":8,"mode":0,"inputs":[{"localized_name":"a","name":"a","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":98},{"localized_name":"b","name":"b","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":99},{"localized_name":"c","name":"c","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":null},{"localized_name":"expression","name":"expression","type":"INT,FLOAT,IMAGE,LATENT","widget":{"name":"expression"},"link":null}],"outputs":[{"localized_name":"整数","name":"INT","type":"INT","links":[144,154,155]},{"localized_name":"浮点","name":"FLOAT","type":"FLOAT","links":[]}],"title":"new_height","properties":{"cnr_id":"comfyui-custom-scripts","ver":"f2838ed5e59de4d73cde5c98354b87a8d3200190"},"widgets_values":["a*b",[false,true]],"color":"#232","bgcolor":"#353"},{"id":66,"type":"MathExpression|pysssss","pos":[-732.7743530273438,245.77195739746094],"size":[400,200],"flags":{},"order":14,"mode":0,"inputs":[{"localized_name":"a","name":"a","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":154},{"localized_name":"b","name":"b","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":153},{"localized_name":"c","name":"c","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":null},{"localized_name":"expression","name":"expression","type":"INT,FLOAT,IMAGE,LATENT","widget":{"name":"expression"},"link":null}],"outputs":[{"localized_name":"整数","name":"INT","type":"INT","links":[109]},{"localized_name":"浮点","name":"FLOAT","type":"FLOAT","links":null}],"title":"y","properties":{"cnr_id":"comfyui-custom-scripts","ver":"f2838ed5e59de4d73cde5c98354b87a8d3200190"},"widgets_values":["(b-a)/2",[false,true]],"color":"#232","bgcolor":"#353"},{"id":59,"type":"MathExpression|pysssss","pos":[-1162.70556640625,-16.67047119140625],"size":[401.7909240722656,205.37255859375],"flags":{},"order":7,"mode":0,"inputs":[{"localized_name":"a","name":"a","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":96},{"localized_name":"b","name":"b","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":97},{"localized_name":"c","name":"c","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":null},{"localized_name":"expression","name":"expression","type":"INT,FLOAT,IMAGE,LATENT","widget":{"name":"expression"},"link":null}],"outputs":[{"localized_name":"整数","name":"INT","type":"INT","links":[139,145]},{"localized_name":"浮点","name":"FLOAT","type":"FLOAT","links":[]}],"title":"new_width","properties":{"cnr_id":"comfyui-custom-scripts","ver":"f2838ed5e59de4d73cde5c98354b87a8d3200190"},"widgets_values":["max(1,floor(a*b))",[false,true]],"color":"#232","bgcolor":"#353"},{"id":65,"type":"MathExpression|pysssss","pos":[-738.3681640625,-15.654594421386719],"size":[400,200],"flags":{},"order":13,"mode":0,"inputs":[{"localized_name":"a","name":"a","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":139},{"localized_name":"b","name":"b","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":151},{"localized_name":"c","name":"c","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":null},{"localized_name":"expression","name":"expression","type":"INT,FLOAT,IMAGE,LATENT","widget":{"name":"expression"},"link":null}],"outputs":[{"localized_name":"整数","name":"INT","type":"INT","links":[108]},{"localized_name":"浮点","name":"FLOAT","type":"FLOAT","links":null}],"title":"x","properties":{"cnr_id":"comfyui-custom-scripts","ver":"f2838ed5e59de4d73cde5c98354b87a8d3200190"},"widgets_values":["(b-a)/2",[false,true]],"color":"#232","bgcolor":"#353"},{"id":85,"type":"ImageToMask","pos":[-1282.753662109375,-380.6737365722656],"size":[270,58],"flags":{},"order":11,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"IMAGE","link":192},{"localized_name":"通道","name":"channel","type":"COMBO","widget":{"name":"channel"},"link":null}],"outputs":[{"localized_name":"遮罩","name":"MASK","type":"MASK","links":[193]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.49","Node name for S&R":"ImageToMask"},"widgets_values":["alpha"],"color":"#323","bgcolor":"#535"},{"id":64,"type":"ImageCompositeMasked","pos":[-1280.5755615234375,-283.92962646484375],"size":[279.0980529785156,146],"flags":{},"order":15,"mode":0,"inputs":[{"localized_name":"目标图像","name":"destination","type":"IMAGE","link":126},{"localized_name":"来源图像","name":"source","type":"IMAGE","link":156},{"localized_name":"遮罩","name":"mask","shape":7,"type":"MASK","link":193},{"localized_name":"x","name":"x","type":"INT","widget":{"name":"x"},"link":108},{"localized_name":"y","name":"y","type":"INT","widget":{"name":"y"},"link":109},{"localized_name":"缩放来源图像","name":"resize_source","type":"BOOLEAN","widget":{"name":"resize_source"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[124,135]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.49","Node name for S&R":"ImageCompositeMasked"},"widgets_values":[0,0,false],"color":"#323","bgcolor":"#535"},{"id":67,"type":"PreviewImage","pos":[-851.6939086914062,-694.2723388671875],"size":[548.6305541992188,565.0387573242188],"flags":{},"order":16,"mode":0,"inputs":[{"localized_name":"图像","name":"images","type":"IMAGE","link":124}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.49","Node name for S&R":"PreviewImage"},"widgets_values":[]},{"id":75,"type":"MathExpression|pysssss","pos":[-1576.4935302734375,-650.5653686523438],"size":[400,200],"flags":{},"order":10,"mode":0,"inputs":[{"localized_name":"a","name":"a","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":155},{"localized_name":"b","name":"b","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":null},{"localized_name":"c","name":"c","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":null},{"localized_name":"expression","name":"expression","type":"INT,FLOAT,IMAGE,LATENT","widget":{"name":"expression"},"link":null}],"outputs":[{"localized_name":"整数","name":"INT","type":"INT","links":[149,150,151,153]},{"localized_name":"浮点","name":"FLOAT","type":"FLOAT","links":[]}],"title":"empty_image_width","properties":{"cnr_id":"comfyui-custom-scripts","ver":"f2838ed5e59de4d73cde5c98354b87a8d3200190"},"widgets_values":["a*1.0526",[false,true]]},{"id":61,"type":"EmptyImage","pos":[-1139.8436279296875,-604.686279296875],"size":[270,130],"flags":{},"order":12,"mode":0,"inputs":[{"localized_name":"宽度","name":"width","type":"INT","widget":{"name":"width"},"link":149},{"localized_name":"高度","name":"height","type":"INT","widget":{"name":"height"},"link":150},{"localized_name":"批量大小","name":"batch_size","type":"INT","widget":{"name":"batch_size"},"link":null},{"localized_name":"颜色","name":"color","type":"INT","widget":{"name":"color"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[126]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.49","Node name for S&R":"EmptyImage"},"widgets_values":[3000,3000,1,16777215]},{"id":58,"type":"MathExpression|pysssss","pos":[-1576.928466796875,250.95706176757812],"size":[400,200],"flags":{},"order":6,"mode":0,"inputs":[{"localized_name":"a","name":"a","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":93},{"localized_name":"b","name":"b","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":94},{"localized_name":"c","name":"c","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":null},{"localized_name":"expression","name":"expression","type":"INT,FLOAT,IMAGE,LATENT","widget":{"name":"expression"},"link":null}],"outputs":[{"localized_name":"整数","name":"INT","type":"INT","links":null},{"localized_name":"浮点","name":"FLOAT","type":"FLOAT","links":[97,99]}],"properties":{"cnr_id":"comfyui-custom-scripts","ver":"f2838ed5e59de4d73cde5c98354b87a8d3200190"},"widgets_values":["2700/max(a,b)",[false,true]],"color":"#232","bgcolor":"#353"},{"id":63,"type":"ImageScale","pos":[-1577.7576904296875,-323.5600280761719],"size":[270,130],"flags":{},"order":9,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"IMAGE","link":187},{"localized_name":"缩放算法","name":"upscale_method","type":"COMBO","widget":{"name":"upscale_method"},"link":null},{"localized_name":"宽度","name":"width","type":"INT","widget":{"name":"width"},"link":145},{"localized_name":"高度","name":"height","type":"INT","widget":{"name":"height"},"link":144},{"localized_name":"裁剪","name":"crop","type":"COMBO","widget":{"name":"crop"},"link":null}],"outputs":[{"localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[156,192]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.49","Node name for S&R":"ImageScale"},"widgets_values":["lanczos",512,512,"disabled"],"color":"#323","bgcolor":"#535"},{"id":77,"type":"ImageToMask","pos":[-2267.451904296875,92.74114227294922],"size":[270,58],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"IMAGE","link":160},{"localized_name":"通道","name":"channel","type":"COMBO","widget":{"name":"channel"},"link":null}],"outputs":[{"localized_name":"遮罩","name":"MASK","type":"MASK","links":[173]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.49","Node name for S&R":"ImageToMask"},"widgets_values":["alpha"]},{"id":54,"type":"Load Image Batch","pos":[-1952.458251953125,-654.5249633789062],"size":[329.7445373535156,270],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"mode","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"index","name":"index","type":"INT","widget":{"name":"index"},"link":null},{"localized_name":"label","name":"label","type":"STRING","widget":{"name":"label"},"link":null},{"localized_name":"path","name":"path","type":"STRING","widget":{"name":"path"},"link":null},{"localized_name":"pattern","name":"pattern","type":"STRING","widget":{"name":"pattern"},"link":null},{"localized_name":"allow_RGBA_output","name":"allow_RGBA_output","type":"COMBO","widget":{"name":"allow_RGBA_output"},"link":null},{"localized_name":"filename_text_extension","name":"filename_text_extension","shape":7,"type":"COMBO","widget":{"name":"filename_text_extension"},"link":null}],"outputs":[{"localized_name":"image","name":"image","type":"IMAGE","links":[88]},{"localized_name":"filename_text","name":"filename_text","type":"STRING","links":null}],"properties":{"cnr_id":"was-ns","ver":"3.0.1","Node name for S&R":"Load Image Batch"},"widgets_values":["incremental_image",26114433535204,"randomize",0,"Batch 001","E:\\ComfyUI\\ComfyUI-aki-v2\\ComfyUI\\input\\work\\products\\6946183300640","*","false","true"],"color":"#223","bgcolor":"#335"}],"links":[[88,54,0,52,0,"IMAGE"],[93,57,0,58,0,"INT,FLOAT,IMAGE,LATENT"],[94,57,1,58,1,"INT,FLOAT,IMAGE,LATENT"],[96,57,0,59,0,"INT,FLOAT,IMAGE,LATENT"],[97,58,1,59,1,"INT,FLOAT,IMAGE,LATENT"],[98,57,1,60,0,"INT,FLOAT,IMAGE,LATENT"],[99,58,1,60,1,"INT,FLOAT,IMAGE,LATENT"],[108,65,0,64,3,"INT"],[109,66,0,64,4,"INT"],[124,64,0,67,0,"IMAGE"],[126,61,0,64,0,"IMAGE"],[135,64,0,55,0,"IMAGE"],[139,59,0,65,0,"INT,FLOAT,IMAGE,LATENT"],[144,60,0,63,3,"INT"],[145,59,0,63,2,"INT"],[149,75,0,61,0,"INT"],[150,75,0,61,1,"INT"],[151,75,0,65,1,"INT,FLOAT,IMAGE,LATENT"],[153,75,0,66,1,"INT,FLOAT,IMAGE,LATENT"],[154,60,0,66,0,"INT,FLOAT,IMAGE,LATENT"],[155,60,0,75,0,"INT,FLOAT,IMAGE,LATENT"],[156,63,0,64,1,"IMAGE"],[160,52,0,77,0,"IMAGE"],[173,77,0,80,0,"MASK"],[180,81,0,57,0,"IMAGE"],[181,52,0,81,0,"IMAGE"],[182,80,2,81,1,"INT"],[183,80,3,81,2,"INT"],[184,80,4,81,3,"INT"],[185,80,5,81,4,"INT"],[187,81,0,63,0,"IMAGE"],[192,63,0,85,0,"IMAGE"],[193,85,0,64,2,"MASK"]],"groups":[{"id":1,"title":"box_crop","bounding":[-2284.26953125,19.141145706176758,673.5885009765625,425.8496398925781],"color":"#3f789e","font_size":24,"flags":{}},{"id":2,"title":"Basic","bounding":[-2286.502197265625,-728.1249389648438,679.63525390625,726.1851196289062],"color":"#b06634","font_size":24,"flags":{}},{"id":3,"title":"Math","bounding":[-1582.602294921875,-104.47686767578125,1285.06298828125,554.666259765625],"color":"#8A8","font_size":24,"flags":{}},{"id":4,"title":"backingground_White","bounding":[-1586.4935302734375,-724.165283203125,726.64990234375,283.6000061035156],"color":"#A88","font_size":24,"flags":{}},{"id":5,"title":"image","bounding":[-1582.703125,-422.22686767578125,719.1843872070312,315.3966369628906],"color":"#a1309b","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":1.0152559799477476,"offset":[2853.6372248868884,830.8635589888398]}},"version":0.4}